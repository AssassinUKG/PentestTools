#!/bin/bash -e
# Authors: JOF
# last updated: 07/10/2021

RED='\033[1;31m'
GREEN='\033[1;32m'
NC='\033[0m'

tools_dir="/opt/PentestTools/"

windows_tools="${tools_dir}/windows"
linux_tools="${tools_dir}/linux"
other_tools="${tools_dir}/other"
mobile_tools="${tools_dir}/mobile"
cloud_tools="${tools_dir}/cloud"

get_latest_releases() {
	urls=$(curl -s $1/releases/latest | grep "tag" | cut -d "\"" -f 2);
	for u in $urls; do
		files=$(curl -s $u | grep "releases/download"| cut -d "\"" -f 2);
		for f in $files; do
			wget -q -N "https://github.com/"$f -P $2/;
		done;
	done;
}

get_pentest_tools() {

	mkdir -p ${windows_tools}
	mkdir -p ${linux_tools}
	mkdir -p ${other_tools}
	mkdir -p ${cloud_tools}

	#-------------------------------------------------------Windows----------------------------------------------------------
	echo -e "${GREEN}Getting Windows tools:${NC}"

	#Windows Misc Utilities 
	echo -e "\tbat2exe"
	wget -q "https://raw.githubusercontent.com/npocmaka/batch.scripts/master/hybrids/iexpress/bat2exeIEXP.bat" -O ${windows_tools}/bat2exeIEXP.bat
	wget -q "https://raw.githubusercontent.com/npocmaka/batch.scripts/master/hybrids/.net/bat2exe.bat" -O ${windows_tools}/bat2exe.bat
	echo -e "\tPause Process"	
	wget -q "https://raw.githubusercontent.com/besimorhino/Pause-Process/master/pause-process.ps1" -O ${windows_tools}/pause-process.ps1
	echo -e "\tScreenshot"	
	wget -q "https://raw.githubusercontent.com/obscuresec/PowerShell/master/Get-TimedScreenshot" -O ${windows_tools}/Get-TimedScreenshot.ps1
	echo -e "\tPPID-Spoof"
	wget -q  "https://raw.githubusercontent.com/decoder-it/psgetsystem/master/psgetsys.ps1" -O ${windows_tools}/psgetsys.ps1
	echo -e "\tGet-Keystrokes"
	wget -q "https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-Keystrokes.ps1" -O ${windows_tools}/Get-Keystrokes.ps1
	echo -e "\tInvoke-MsBuild"
	get_latest_releases "https://github.com/deadlydog/Invoke-MsBuild/" ${windows_tools}
	echo -e "\tInvoke-NinjaCopy"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/collection/Invoke-NinjaCopy.ps1" -O ${windows_tools}/Invoke-NinjaCopy.ps1
	echo -e "\tGet-ClipboardContents"
	wget -q "https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/collection/Get-ClipboardContents.ps1" -O ${windows_tools}/Get-ClipboardContents.ps1
	echo -e "\tLockLess"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/LockLess.exe" -O ${windows_tools}/LockLess.exe

	#Priv Esc
	echo -e "\tWindows Exploit Suggester"
	wget -q "https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/776bd91259c081588f99b5b0b9aa54e8c5fdf5ad/windows-exploit-suggester.py" -O ${windows_tools}/windows-exploit-suggester.py
	wget -q "https://raw.githubusercontent.com/bitsadmin/wesng/a67d7a74db7f68d6efee4b8dbd6293fc4b4bcf34/wes.py" -O ${windows_tools}/wes.py
	echo -e "\tWindows Privesc Check"
	wget -q "https://raw.githubusercontent.com/pentestmonkey/windows-privesc-check/9f304fdf317536c41120f305f62a37bdeefddfdc/windows_privesc_check.py" -O ${windows_tools}/windows_privesc_check.py
	wget -q "https://github.com/pentestmonkey/windows-privesc-check/blob/9f304fdf317536c41120f305f62a37bdeefddfdc/windows-privesc-check2.exe" -O ${windows_tools}/windows-privesc-check2.exe
	echo -e "\twindowsEnum"
	wget -q "https://raw.githubusercontent.com/azmatt/windowsEnum/97aa162fded5e82ac208d258cecc033a019b578b/windowsEnum.bat" -O ${windows_tools}/windowsEnum.bat
	echo -e "\twinPEAS"
	wget -q "https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/winPEAS/winPEASbat/winPEAS.bat" -O ${windows_tools}/winPEAS.bat
	wget -q "https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/winPEAS/winPEASexe/binaries/x64/Release/winPEASx64.exe" -O ${windows_tools}/winPEASx64.exe
	wget -q "https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/winPEAS/winPEASexe/binaries/x86/Release/winPEASx86.exe" -O ${windows_tools}/winPEASx86.exe
	echo -e "\tInvoke-winPEAS"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/privesc/Invoke-winPEAS.ps1" -O ${windows_tools}/Invoke-winPEAS.ps1
	echo -e "\tPrivescCheck"
	wget -q "https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1" -O ${windows_tools}/PrivescCheck.ps1
	echo -e "\tRattler"
	get_latest_releases "https://github.com/sensepost/rattler" ${windows_tools}
	echo -e "\tPowerUp"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/privesc/PowerUp.ps1" -O ${windows_tools}/PowerUp.ps1
	echo -e "\tSeatBelt"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/Seatbelt.exe" -O ${windows_tools}/Seatbelt.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Seatbelt.ps1" -O ${windows_tools}/Invoke-Seatbelt.ps1
	echo -e "\tWatson"
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/Watson.exe" -O ${windows_tools}/Watson.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpWatson.ps1" -O ${windows_tools}/Invoke-SharpWatson.ps1
	echo -e "\tSharpUp"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SharpUp.exe" -O ${windows_tools}/SharpUp.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpUp.ps1" -O ${windows_tools}/Invoke-SharpUp.ps1

	#Credentials collection
	echo -e "\tMimikatz"
	get_latest_releases "https://github.com/gentilkiwi/mimikatz" ${windows_tools}
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/credentials/Invoke-Mimikatz.ps1" -O ${windows_tools}/Invoke-Mimikatz.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/loadmimi.ps1" -O ${windows_tools}/loadmimi.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/mimi.ps1" -O ${windows_tools}/mimi.ps1
	echo -e "\tSafetyKatz"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SafetyKatz.exe" -O ${windows_tools}/SafetyKatz.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SafetyKatz.ps1" -O ${windows_tools}/Invoke-SafetyKatz.ps1
	echo -e "\tpypykatz"
	get_latest_releases "https://github.com/skelsec/pypykatz" ${windows_tools}
	echo -e "\tMinidump"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/collection/Out-Minidump.ps1" -O ${windows_tools}/Out-Minidump.ps1
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SharpDump.exe" -O ${windows_tools}/SharpDump.exe
	wget -q "https://github.com/b4rtik/ATPMiniDump/archive/master.zip" -O ${windows_tools}/ATPMiniDump.zip	
	echo -e "\tspraykatz"
	wget -q "https://github.com/aas-n/spraykatz/archive/master.zip" -O ${windows_tools}/spraykatz.zip
	echo -e "\tInvoke-PowerDump"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/credentials/Invoke-PowerDump.ps1" -O ${windows_tools}/Invoke-PowerDump.ps1
	echo -e "\tInvoke-Internalmonologue"
	wget -q "https://raw.githubusercontent.com/paranoidninja/Pandoras-Box/master/powershell/Invoke-InternalMonologue.ps1" -O ${windows_tools}/Invoke-Internalmonologue.ps1
	echo -e "\tGet-WLAN-Keys"
	wget -q "https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Get-WLAN-Keys.ps1" -O ${windows_tools}/Get-WLAN-Keys.ps1
	echo -e "\tWebDump"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/collection/Get-ChromeDump.ps1" -O ${windows_tools}/Get-ChromeDump.ps1
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SharpChrome.exe" -O ${windows_tools}/SharpChrome.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Sharpweb.ps1" -O ${windows_tools}/Invoke-Sharpweb.ps1
	echo -e "\tPasshunt"
	wget -q "https://raw.githubusercontent.com/Dionach/PassHunt/master/passhunt.py" -O ${windows_tools}/passhunt.py
	wget -q "https://raw.githubusercontent.com/Dionach/PassHunt/master/passhunt.exe" -O ${windows_tools}/passhunt.exe
	echo -e "\tSnaffler"
	get_latest_releases "https://github.com/SnaffCon/Snaffler" ${windows_tools}
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Snaffler.ps1" -O ${windows_tools}/Invoke-Snaffler.ps1
	echo -e "\tKeeThief"
	wget -q "https://raw.githubusercontent.com/GhostPack/KeeThief/master/PowerShell/KeeThief.ps1" -O ${windows_tools}/KeeThief.ps1
	echo -e "\tSeriousSAM"
	get_latest_releases "https://github.com/GossiTheDog/HiveNightmare/" ${windows_tools}
	echo -e "\tSharpChromium"
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/SharpChromium.exe" -O ${windows_tools}/SharpChromium.exe
	echo -e "\tSessionGopher"
	wget -q "https://raw.githubusercontent.com/Arvanaghi/SessionGopher/master/SessionGopher.ps1" -O ${windows_tools}/SessionGopher.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/segoph.ps1" -O ${windows_tools}/segoph.ps1
	echo -e "\tWCMDump"
	wget -q "https://raw.githubusercontent.com/peewpw/Invoke-WCMDump/master/Invoke-WCMDump.ps1" -O ${windows_tools}/Invoke-WCMDump.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/DumpWCM.ps1" -O ${windows_tools}/DumpWCM.ps1
	echo -e "\tSafetyDump"
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/PowershellScripts/SafetyDump.ps1" -O ${windows_tools}/SafetyDump.ps1
	echo -e "\tGet-GPPPassword"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/privesc/Get-GPPPassword.ps1" -O ${windows_tools}/Get-GPPPassword.ps1
	echo -e "\tSharpSecDump"
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/SharpSecDump.exe" -O ${windows_tools}/SharpSecDump.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpSecDump.ps1" -O ${windows_tools}/Invoke-SharpSecDump.ps1
	echo -e "\tSharpDPAPI"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SharpDPAPI.exe" -O ${windows_tools}/SharpDPAPI.exe
	echo -e "\tSharpCloud"
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/SharpCloud.exe" -O ${windows_tools}/SharpCloud.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpCloud.ps1" -O ${windows_tools}/Invoke-SharpCloud.ps1

	#Remote connection
	echo -e "\tPowercat"
	wget -q "https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1" -O ${windows_tools}/powercat.ps1
	echo -e "\tInvoke-PowerShellTCP"
	wget -q "https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1" -O ${windows_tools}/Invoke-PowerShellTcp.ps1
	echo -e "\tSet-RemoteWMI"
	wget -q "https://raw.githubusercontent.com/samratashok/nishang/master/Backdoors/Set-RemoteWMI.ps1" -O ${windows_tools}/Set-RemoteWMI.ps1
	echo -e "\tSet-RemotePSRemoting"
	wget -q "https://raw.githubusercontent.com/samratashok/nishang/master/Backdoors/Set-RemotePSRemoting.ps1" -O ${windows_tools}/Set-RemotePSRemoting.ps1
	echo -e "\tSCShell"
	wget -q "https://raw.githubusercontent.com/Mr-Un1k0d3r/SCShell/master/SCShell.exe" -O ${windows_tools}/SCShell.exe
	wget -q "https://raw.githubusercontent.com/Mr-Un1k0d3r/SCShell/master/scshell.py" -O ${windows_tools}/scshell.py
	echo -e "\tDCOM"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/lateral_movement/Invoke-DCOM.ps1" -O ${windows_tools}/Invoke-DCOM.ps1
	wget -q "https://github.com/rvrsh3ll/SharpCOM/archive/master.zip" -O ${windows_tools}/SharpCOM.zip
	echo -e "\tmssql_shell"
	wget -q "https://raw.githubusercontent.com/Alamot/code-snippets/master/mssql/mssql_shell.py" -O ${windows_tools}/mssql_shell.py
	echo -e "\tSharpExec"
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/SharpExec.exe" -O ${windows_tools}/SharpExec.exe
	echo -e "\tSharpWMI"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SharpWMI.exe" -O ${windows_tools}/SharpWMI.exe

	#Evasion and bypass
	echo -e "\tFind-AVSignature"
	wget -q "https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/AntivirusBypass/Find-AVSignature.ps1" -O ${windows_tools}/Find-AVSignature.ps1
	echo -e "\tInvoke-Obfuscation"
	wget -q "https://github.com/danielbohannon/Invoke-Obfuscation/archive/master.zip" -O ${windows_tools}/Invoke-Obfuscation.zip
	echo -e "\tPsBypassCLM"
	wget -q "https://raw.githubusercontent.com/padovah4ck/PSByPassCLM/93f9a248064b3c6d474894ed057afdd8a2b736f9/PSBypassCLM/PSBypassCLM/bin/x64/Debug/PsBypassCLM.exe" -O ${windows_tools}/PsBypassCLM.exe
	echo -e "\tHostRecon"
	wget -q "https://raw.githubusercontent.com/dafthack/HostRecon/master/HostRecon.ps1" -O ${windows_tools}/HostRecon.ps1
	echo -e "\tInvoke-ReflectivePEInjection"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/management/Invoke-ReflectivePEInjection.ps1" -O ${windows_tools}/Invoke-ReflectivePEInjection.ps1
	echo -e "\tMsBuildShell"
	wget -q "https://raw.githubusercontent.com/Cn33liz/MSBuildShell/master/MSBuildShell.csproj" -O ${windows_tools}/MSBuildShell.csproj
	echo -e "\tAMSITrigger"
	get_latest_releases "https://github.com/RythmStick/AMSITrigger" ${windows_tools}
	echo -e "\tCheckPlease"
	wget -q "https://github.com/Arvanaghi/CheckPlease/archive/refs/heads/master.zip" -O ${windows_tools}/CheckPlease.zip
	echo -e "\tChimera"
	wget -q "https://raw.githubusercontent.com/tokyoneon/Chimera/master/chimera.sh" -O ${windows_tools}/chimera.sh
	echo -e "\tPyFuscation"
	wget -q "https://github.com/CBHue/PyFuscation/archive/master.zip" -O ${windows_tools}/PyFuscation.zip
	echo -e "\tThreatCheck"
	wget -q "https://github.com/rasta-mouse/ThreatCheck/archive/master.zip" -O ${windows_tools}/ThreatCheck.zip
	echo -e "\tSharpCradle"
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Invoke-Sharpcradle/master/Invoke-Sharpcradle.ps1" -O ${windows_tools}/Invoke-Sharpcradle.ps1
	echo -e "\tInvoke-BypassUAC"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/privesc/Invoke-BypassUAC.ps1" -O ${windows_tools}/Invoke-BypassUAC.ps1
	echo -e "\tScriptBlockLogBypass"
	wget -q "https://gist.githubusercontent.com/cobbr/d8072d730b24fbae6ffe3aed8ca9c407/raw/fa6dcb69b1f563788af9f3a11a7b07bae34fa8ec/ScriptBlockLogBypass.ps1" -O ${windows_tools}/ScriptBlockLogBypass.ps1
	
	#Macro and WScript
	echo -e "\tEvilClippy"
	wget -q "https://github.com/outflanknl/EvilClippy/archive/master.zip" -O ${windows_tools}/EvilClippy.zip
	echo -e "\tSharpShooter"
	wget -q "https://github.com/mdsecactivebreach/SharpShooter/archive/master.zip" -O ${windows_tools}/SharpShooter.zip
	echo -e "\tOfficePurge"
	get_latest_releases "https://github.com/fireeye/OfficePurge" ${windows_tools}
	echo -e "\tmacro_pack"
	get_latest_releases "https://github.com/sevagas/macro_pack" ${windows_tools}
	echo -e "\tDotNetToJScript"
	wget -q "https://github.com/tyranid/DotNetToJScript/archive/master.zip" -O ${windows_tools}/DotNetToJScript.zip
	
	#WinPwn
	echo -e "\tWinPwn"
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1" -O ${windows_tools}/WinPwn.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/Offline_WinPwn.ps1" -O ${windows_tools}/Offline_WinPwn.ps1
	
	#Inveigh
	echo -e "\tInveigh"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/lateral_movement/Invoke-InveighRelay.ps1" -O ${windows_tools}/Invoke-InveighRelay.ps1
	wget -q "https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Inveigh-Relay.ps1" -O ${windows_tools}/Inveigh-Relay.ps1
	wget -q "https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Inveigh.ps1" -O ${windows_tools}/Inveigh.ps1
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/collection/Invoke-Inveigh.ps1" -O ${windows_tools}/Invoke-Inveigh.ps1
	wget -q "https://github.com/Kevin-Robertson/Inveigh/archive/master.zip" -O ${windows_tools}/Inveigh.zip

	#SMB Enum
	echo -e "\tenum4linux-ng"
	wget -q "https://raw.githubusercontent.com/cddmp/enum4linux-ng/master/enum4linux-ng.py" -O ${windows_tools}/enum4linux-ng.py
	echo -e "\tInvoke-SMBNegotiate"
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/PowershellScripts/Invoke-SMBNegotiate.ps1" -O ${windows_tools}/Invoke-SMBNegotiate.ps1
	
	#Exploits
	echo -e "\tEternalBlue"
	wget -q "https://raw.githubusercontent.com/worawit/MS17-010/master/zzz_exploit.py" -O ${windows_tools}/zzz_exploit.py
	echo -e "\tSpoolerScan"
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/SpoolerScanner/master/SpoolerScan.ps1" -O ${windows_tools}/SpoolerScan.ps1
	echo -e "\tPrintSpoofer"
	get_latest_releases "https://github.com/itm4n/PrintSpoofer" ${windows_tools}
	wget -q "https://raw.githubusercontent.com/dievus/printspoofer/master/PrintSpoofer.exe" -O ${windows_tools}/PrintSpoofer.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/printspoof_interactive.ps1" -O ${windows_tools}/printspoof_interactive.ps1
	echo -e "\tPetitPotam"
	wget -q "https://raw.githubusercontent.com/topotam/PetitPotam/main/PetitPotam.exe" -O ${windows_tools}/PetitPotam.exe
	wget -q "https://raw.githubusercontent.com/topotam/PetitPotam/main/PetitPotam.py" -O ${windows_tools}/PetitPotam.py
	echo -e "\tPrintNightmare"
	wget -q "https://raw.githubusercontent.com/cube0x0/CVE-2021-1675/main/CVE-2021-1675.py" -O ${windows_tools}/CVE-2021-1675.py
	wget -q "https://raw.githubusercontent.com/calebstewart/CVE-2021-1675/main/CVE-2021-1675.ps1" -O ${windows_tools}/CVE-2021-1675.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpPrintNightmare.ps1" -O ${windows_tools}/Invoke-SharpPrintNightmare.ps1
	echo -e "\tWebclientServiceScanner"
	wget -q "https://github.com/Hackndo/WebclientServiceScanner/archive/refs/heads/master.zip"  -O ${windows_tools}/WebclientServiceScanner.zip
	echo -e "\tZerologon"
	wget -q "https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py" -O ${windows_tools}/zerologon_tester.py
	echo -e "\tdementor"
	wget -q "https://gist.githubusercontent.com/3xocyte/cfaf8a34f76569a8251bde65fe69dccc/raw/7c7f09ea46eff4ede636f69c00c6dfef0541cd14/dementor.py" -O ${windows_tools}/dementor.py
	echo -e "\tPotatoes"
	get_latest_releases "https://github.com/ohpe/juicy-potato" ${windows_tools}
	get_latest_releases "https://github.com/antonioCoco/RoguePotato" ${windows_tools}
	wget -q "https://raw.githubusercontent.com/Kevin-Robertson/Tater/master/Tater.ps1"-O ${windows_tools}/Tater.ps1
	wget -q "https://raw.githubusercontent.com/foxglovesec/Potato/master/source/Potato/Potato/bin/Release/Potato.exe" -O ${windows_tools}/Potato.exe
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/SweetPotato.exe" -O ${windows_tools}/SweetPotato.exe
	
	#Web
	echo -e "\twebshell.asp"
	wget -q "https://raw.githubusercontent.com/tennc/webshell/master/asp/webshell.asp" -O ${windows_tools}/webshell.asp
	
	#Tokens
	echo -e "\tIncognito"
	wget -q "https://raw.githubusercontent.com/FSecureLABS/incognito/394545ffb844afcc18e798737cbd070ff3a4eb29/incognito.exe" -O ${windows_tools}/Incognito.exe
	
	#----------------------------------------------------------AD------------------------------------------------------------
	echo -e "${GREEN}Getting AD tools:${NC}"
	
	#AD Module
	echo -e "\tMicrosoft.ActiveDirectory.Management"
	wget -q "https://raw.githubusercontent.com/samratashok/ADModule/master/Microsoft.ActiveDirectory.Management.dll" -O ${windows_tools}/Microsoft.ActiveDirectory.Management.dll

	#AD Collection
	echo -e "\tSharphound Ingestors"
	wget -q "https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.exe" -O ${windows_tools}/SharpHound.exe
	wget -q "https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1" -O ${windows_tools}/SharpHound.ps1
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Sharphound3.ps1" -O ${windows_tools}/Invoke-Sharphound3.ps1
	echo -e "\tAD Recon"
	wget -q "https://raw.githubusercontent.com/sense-of-security/ADRecon/master/ADRecon.ps1" -O ${windows_tools}/ADRecon.ps1
	echo -e "\tGrouper2"
	get_latest_releases "https://github.com/l0ss/Grouper2" ${windows_tools}
	echo -e "\tSharpView"
	wget -q "https://github.com/tevora-threat/SharpView/raw/master/Compiled/SharpView.exe" -O ${windows_tools}/SharpView.exe
	echo -e "\tPowerView"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/situational_awareness/network/powerview.ps1" -O ${windows_tools}/PowerView.ps1

	#ACL
	echo -e "\tADACLScan"
	wget -q "https://raw.githubusercontent.com/canix1/ADACLScanner/master/ADACLScan.ps1" -O ${windows_tools}/ADACLScan.ps1
	echo -e "\tACLight"
	wget -q "https://github.com/cyberark/ACLight/archive/master.zip" -O ${windows_tools}/ACLight.zip
	wget -q "https://raw.githubusercontent.com/cyberark/ACLight/master/ACLight2.ps1" -O ${windows_tools}/ACLight2.ps1
	echo -e "\tDAMP"
	wget -q "https://raw.githubusercontent.com/HarmJ0y/DAMP/master/Add-RemoteRegBackdoor.ps1" -O ${windows_tools}/Add-RemoteRegBackdoor.ps1
	wget -q "https://raw.githubusercontent.com/HarmJ0y/DAMP/master/RemoteHashRetrieval.ps1" -O ${windows_tools}/RemoteHashRetrieval.ps1

	#ADCS
	echo -e "\tADCSPwn"
	get_latest_releases "https://github.com/bats3c/ADCSPwn" ${windows_tools}
	echo -e "\tWhisker"
	wget -q "https://raw.githubusercontent.com/ShutdownRepo/pywhisker/main/pywhisker.py" -O ${windows_tools}/pywhisker.py
	wget -q "https://github.com/eladshamir/Whisker/archive/refs/heads/main.zip" -O ${windows_tools}/Whisker.zip
	echo -e "\tPKINITtools"
	wget -q "https://raw.githubusercontent.com/dirkjanm/PKINITtools/master/getnthash.py" -O ${windows_tools}/getnthash.py
	wget -q "https://raw.githubusercontent.com/dirkjanm/PKINITtools/master/gettgtpkinit.py" -O ${windows_tools}/gettgtpkinit.py
	wget -q "https://raw.githubusercontent.com/dirkjanm/PKINITtools/master/gets4uticket.py" -O ${windows_tools}/gets4uticket.py
	echo -e "\tForgeCert"
	wget -q "https://raw.githubusercontent.com/Flangvik/SharpCollection/master/NetFramework_4.7_Any/ForgeCert.exe" -O ${windows_tools}/ForgeCert.exe
	echo -e "\tPSPKIAudit"
	wget -q "https://github.com/GhostPack/PSPKIAudit/archive/master.zip" ${windows_tools}
	echo -e "\tCertify"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/Certify.exe" -O ${windows_tools}/Certify.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Certify.ps1" -O ${windows_tools}/Invoke-Certify.ps1

	#GPO
	echo -e "\tSharpGPOAbuse"
	wget -q "https://github.com/FSecureLABS/SharpGPOAbuse/archive/master.zip" -O ${windows_tools}/SharpGPOAbuse.zip
	echo -e "\tGPRegistryPolicyParser"
	wget -q "https://raw.githubusercontent.com/PowerShell/GPRegistryPolicyParser/master/GPRegistryPolicyParser.psm1" -O ${windows_tools}/GPRegistryPolicyParser.psm1

	#Kerberos
	echo -e "\tASREPRoast"
	wget -q "https://raw.githubusercontent.com/HarmJ0y/ASREPRoast/master/ASREPRoast.ps1" -O ${windows_tools}/ASREPRoast.ps1
	echo -e "\tGetUserSPNs"
	wget -q "https://raw.githubusercontent.com/nidem/kerberoast/master/GetUserSPNs.ps1" -O ${windows_tools}/GetUserSPNs.ps1
	echo -e "\tKekeo"
	get_latest_releases "https://github.com/gentilkiwi/kekeo" ${windows_tools}
	echo -e "\tticket_converter"
	wget -q "https://raw.githubusercontent.com/Zer1t0/ticket_converter/master/ticket_converter.py" -O ${windows_tools}/ticket_converter.py
	echo -e "\ttargetedKerberoast"
	wget -q "https://raw.githubusercontent.com/ShutdownRepo/targetedKerberoast/main/targetedKerberoast.py" -O ${windows_tools}/targetedKerberoast.py
	echo -e "\tMS14-068"
	wget -q "https://raw.githubusercontent.com/mubix/pykek/master/ms14-068.py" -O ${windows_tools}/ms14-068.py
	echo -e "\tKerberoast"
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/credentials/Invoke-Kerberoast.ps1" -O ${windows_tools}/Invoke-Kerberoast.ps1
	echo -e "\tSharpRoast"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/SharpRoast.exe" -O ${windows_tools}/SharpRoast.exe

	#Mail
	echo -e "\tMailSniper"
	wget -q "https://raw.githubusercontent.com/dafthack/MailSniper/master/MailSniper.ps1" -O ${windows_tools}/MailSniper.ps1

	#Rubeus
	echo -e "\tRubeus"
	wget -q "https://raw.githubusercontent.com/r3motecontrol/Ghostpack-CompiledBinaries/master/Rubeus.exe" -O ${windows_tools}/Rubeus.exe
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Rubeus.ps1" -O ${windows_tools}/Invoke-Rubeus.ps1
	
	#LAPS/gMSA
	echo -e "\tLAPSToolkit"
	wget -q "https://raw.githubusercontent.com/leoloobeek/LAPSToolkit/master/LAPSToolkit.ps1" -O ${windows_tools}/LAPSToolkit.ps1
	echo -e "\tLAPSDumper"
	wget -q "https://raw.githubusercontent.com/n00py/LAPSDumper/main/laps.py" -O ${windows_tools}/laps.py
	echo -e "\tgMSADumper"
	wget -q "https://raw.githubusercontent.com/micahvandeusen/gMSADumper/main/gMSADumper.py" -O ${windows_tools}/gMSADumper.py
	
	#PasswordSpray
	echo -e "\tDomainPasswordSpray"
	wget -q "https://raw.githubusercontent.com/dafthack/DomainPasswordSpray/master/DomainPasswordSpray.ps1" -O ${windows_tools}/DomainPasswordSpray.ps1
	echo -e "\tSharpDomainSpray"
	wget -q "https://github.com/HunnicCyber/SharpDomainSpray/archive/master.zip" -O ${windows_tools}/SharpDomainSpray.zip

	#Delegation
	echo -e "\trbcd"
	wget -q "https://raw.githubusercontent.com/tothi/rbcd-attack/master/rbcd.py" -O ${windows_tools}/rbcd.py
	echo -e "\tUnconstrained Delegation"
	wget -q "https://raw.githubusercontent.com/dirkjanm/krbrelayx/master/printerbug.py" -O ${windows_tools}/printerbug.py
	wget -q "https://raw.githubusercontent.com/dirkjanm/krbrelayx/master/dnstool.py" -O ${windows_tools}/dnstool.py
	wget -q "https://raw.githubusercontent.com/dirkjanm/krbrelayx/master/addspn.py" -O ${windows_tools}/addspn.py
	wget -q "https://raw.githubusercontent.com/dirkjanm/krbrelayx/master/krbrelayx.py" -O ${windows_tools}/krbrelayx.py
	
	#DNS
	echo -e "\tDNSUpdate"
	wget -q "https://raw.githubusercontent.com/Sagar-Jangam/DNSUpdate/master/DNSUpdate.py" -O ${windows_tools}/DNSUpdate.py
	echo -e "\tPowermad"
	wget -q "https://raw.githubusercontent.com/Kevin-Robertson/Powermad/master/Powermad.ps1" -O ${windows_tools}/Powermad.ps1
	wget -q "https://raw.githubusercontent.com/Kevin-Robertson/Powermad/master/Invoke-DNSUpdate.ps1" -O ${windows_tools}/Invoke-DNSUpdate.ps1

	#DCSync
	echo -e "\tInvoke-DCSync"	
	wget -q "https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/credentials/Invoke-DCSync.ps1" -O ${windows_tools}/Invoke-DCSync.ps1

	#Monitor
	get_latest_releases "https://github.com/p0dalirius/LDAPmonitor" ${windows_tools}

	#SQL
	echo -e "\tPowerUpSQL"
	wget -q "https://raw.githubusercontent.com/NetSPI/PowerUpSQL/master/PowerUpSQL.ps1" -O ${windows_tools}/PowerUpSQL.ps1
	echo -e "\tESC"
	get_latest_releases "https://github.com/NetSPI/ESC" ${windows_tools}

	#------------------------------------------------Linux-------------------------------------------------------
	echo -e "${GREEN}Getting Linux tools...${NC}"
	
	#Priv Esc
	echo -e "\tLinux Exploit Suggester"
	wget -q "https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh" -O ${linux_tools}/linux-exploit-suggester.sh
	wget -q "https://raw.githubusercontent.com/jondonas/linux-exploit-suggester-2/ba9ef75a44ba934a33f5b56033d9b1435fea74ae/linux-exploit-suggester-2.pl" -O ${linux_tools}/linux-exploit-suggester-2.pl
	echo -e "\tlinuxprivchecker"
	wget -q "https://raw.githubusercontent.com/sleventyeleven/linuxprivchecker/e048a31a8852a604b4f953c39e2d9b6d08c5d6bb/linuxprivchecker.py" -O ${linux_tools}/linuxprivchecker.py
	echo -e "\tpspy"
	get_latest_releases "https://github.com/DominicBreuker/pspy" ${linux_tools}
	echo -e "\tLinEnum"
	wget -q "https://raw.githubusercontent.com/rebootuser/LinEnum/54402e94500e7d1f2c9702c3d73cfa40d8578a5b/LinEnum.sh" -O ${linux_tools}/LinEnum.sh
	echo -e "\tlinux-smart-enumeration"
	wget -q "https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh" -O ${linux_tools}/lse.sh
	echo -e "\tlinPEAS"
	wget -q "https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh" -O ${linux_tools}/linpeas.sh
	
	#Remote connection
	echo -e "\tpwncat"
	wget -q "https://github.com/calebstewart/pwncat/archive/master.zip" -O ${linux_tools}/pwncat.zip
	
	#------------------------------------------------Cloud-------------------------------------------------------
	echo -e "${GREEN}Getting Cloud tools...${NC}"
	echo -e "\tProwler"
	wget -q "https://github.com/toniblyx/prowler/archive/master.zip" -O ${cloud_tools}/prowler.zip
	echo -e "\tOffice365_Extractor"
	wget -q "https://raw.githubusercontent.com/PwC-IR/Office-365-Extractor/master/Office365_Extractor.ps1" -O ${cloud_tools}/Office365_Extractor.ps1
	echo -e "\tPowerZure"
	wget -q "https://raw.githubusercontent.com/hausec/PowerZure/master/PowerZure.psm1" -O ${cloud_tools}/PowerZure.psm1
	echo -e "\tAzureHound"
	wget -q "https://raw.githubusercontent.com/BloodHoundAD/AzureHound/master/AzureHound.ps1" -O ${cloud_tools}/AzureHound.ps1
	wget -q "https://raw.githubusercontent.com/BloodHoundAD/AzureHound/master/import.py" -O ${cloud_tools}/import_AzureHound.py
	echo -e "\to365recon"
	wget -q "https://raw.githubusercontent.com/nyxgeek/o365recon/master/o365recon.ps1" -O ${cloud_tools}/o365recon.ps1
	echo -e "\to365creeper"
	wget -q "https://raw.githubusercontent.com/LMGsec/o365creeper/master/o365creeper.py" -O ${cloud_tools}/o365creeper.py
	echo -e "\tGet-CRTReport"
	wget -q "https://raw.githubusercontent.com/CrowdStrike/CRT/main/Get-CRTReport.ps1" -O ${cloud_tools}/Get-CRTReport.ps1
	echo -e "\tAzuriteExplorer"
	wget -q "https://raw.githubusercontent.com/FSecureLABS/Azurite/master/AzuriteExplorer.ps1" -O ${cloud_tools}/AzuriteExplorer.ps1
	echo -e "\tSkyArk"
	wget -q "https://github.com/cyberark/SkyArk/archive/master.zip" -O ${cloud_tools}/SkyArk.zip
	echo -e "\tMicroBurst"
	wget -q "https://github.com/NetSPI/MicroBurst/archive/master.zip" -O ${cloud_tools}/MicroBurst.zip
	echo -e "\tAzureADRecon"
	wget -q "https://raw.githubusercontent.com/adrecon/AzureADRecon/master/AzureADRecon.ps1" -O ${cloud_tools}/AzureADRecon.ps1
	echo -e "\tMSOLSpray"
	wget -q "https://raw.githubusercontent.com/dafthack/MSOLSpray/master/MSOLSpray.ps1" -O ${cloud_tools}/MSOLSpray.ps1
	echo -e "\tadconnectdump"
	wget -q "https://github.com/fox-it/adconnectdump/archive/master.zip" -O ${cloud_tools}/adconnectdump.zip
	echo -e "\tazuread_decrypt_msol_v2"
	wget -q "https://gist.githubusercontent.com/xpn/f12b145dba16c2eebdd1c6829267b90c/raw/6d4f360d83b67c3b86540ad801805c20915ea1ae/azuread_decrypt_msol_v2.ps1" -O ${cloud_tools}/azuread_decrypt_msol_v2.ps1
	echo -e "\tTeamViewerDecrypt"
	wget -q "https://raw.githubusercontent.com/S3cur3Th1sSh1t/TeamViewerDecrypt/master/TeamViewerDecrypt.ps1" -O ${windows_tools}/TeamViewerDecrypt.ps1

	#------------------------------------------------Other-------------------------------------------------------
	echo -e "${GREEN}Getting Other tools...${NC}"
	echo -e "\tFirefox Decrypt"
	wget -q "https://raw.githubusercontent.com/unode/firefox_decrypt/master/firefox_decrypt.py" -O ${other_tools}/firefox_decrypt.py
	echo -e "\tVNC Password Decrypt"
	wget -q "https://www.raymond.cc/blog/wp-content/plugins/download-monitor/download.php?id=232" -O ${other_tools}/vncpwd.zip
	echo -e "\tgit dumper"
	wget -q "https://raw.githubusercontent.com/arthaud/git-dumper/master/git_dumper.py" -O ${other_tools}/git_dumper.py
	echo -e "\tMcAfee Password Decrypt"
	wget -q "https://raw.githubusercontent.com/funoverip/mcafee-sitelist-pwd-decryption/master/mcafee_sitelist_pwd_decrypt.py" -O ${other_tools}/mcafee_sitelist_pwd_decrypt.py
	echo -e "\tHashcat OneRuletoRuleThemAll"
	wget -q "https://raw.githubusercontent.com/NotSoSecure/password_cracking_rules/master/OneRuleToRuleThemAll.rule" -O ${other_tools}/OneRuleToRuleThemAll.rule
	echo -e "\tConvert-Invoke-Kerberoast"
	wget -q "https://raw.githubusercontent.com/blacklanternsecurity/Convert-Invoke-Kerberoast/master/Convert-Invoke-Kerberoast.py" -O ${other_tools}/Convert-Invoke-Kerberoast.py
	echo -e "\tnessus-merger"
	wget -q "https://raw.githubusercontent.com/leonteale/pentestpackage/master/NEssus_merger.py" -O ${other_tools}/nessus_merger.py
	echo -e "\tsmtp-cli"
	wget -q "https://raw.githubusercontent.com/mludvig/smtp-cli/master/smtp-cli" -O ${other_tools}/smtp-cli
	echo -e "\tdnschef"
	wget -q "https://raw.githubusercontent.com/iphelix/dnschef/master/dnschef.py" -O ${other_tools}/dnschef.py
	echo -e "\tmremoteng_decrypt"
	wget -q "https://raw.githubusercontent.com/haseebT/mRemoteNG-Decrypt/master/mremoteng_decrypt.py" -O ${other_tools}/mremoteng_decrypt.py
	echo -e "\tJSgen"
	wget -q "https://gitlab.com/0x4ndr3/blog/raw/master/JSgen/JSgen.py" -O ${other_tools}/JSgen.py
	echo -e "\tbyp4xx"
	wget -q "https://raw.githubusercontent.com/lobuhi/byp4xx/main/byp4xx.py" -O ${other_tools}/byp4xx.py
	echo -e "\tspoofcheck"
	wget -q "https://raw.githubusercontent.com/BishopFox/spoofcheck/master/spoofcheck.py" -O ${other_tools}/spoofcheck.py
	echo -e "\tdnscan"
	wget -q "https://raw.githubusercontent.com/rbsec/dnscan/master/dnscan.py" -O ${other_tools}/dnscan.py
	echo -e "\twinscppasswd"
	get_latest_releases "https://github.com/anoopengineer/winscppasswd" ${other_tools}
	echo -e "\tEyeWitness"
	get_latest_releases "https://github.com/FortyNorthSecurity/EyeWitness" ${other_tools}

	#Docker
	echo -e "\tdeepce"
	wget -q "https://raw.githubusercontent.com/stealthcopter/deepce/main/deepce.sh" -O ${other_tools}/deepce.sh

}

#### Calling functions
get_pentest_tools || { echo -e "\n\n${RED}[Failure]${NC} Downloading pentest tools failed.. exiting script!\n"; exit 1; }

echo -e "\n${GREEN}[Success]${NC} finished! \n"
